# Backup
### Как пользоваться
Запустить из команданой строки java -jar Backup.jar -h 
И все будет описано.

На данном этапе представляю себе такую структуру:
* backup/current - полный текущий клон бэкап данных
* backup/history - история изменения файлов. Т.е. туда будут складываться файлы из current с датой изменения файлов.

Так же есть требования, которым я стараюсь следовать.

1. Запускалось автоматически, по таймеру
2. Имело интерактивный режим работы в случае массовых изменений файлов (определить максимальный порог количества изменённых файлов на основе наработанной ежедневной статистики работы первой версии архивирования)
3. Предупреждать о необходимости ручного вмешательства в процесс архивирования на основе или ранее сформированного протокола, или на основе аварийного завершения с отправкой SMS на телефон или выдачи предупреждения в экран наблюдения за состоянием информационной системы предприятия
4. Старые версии обновлённых файлов в архиве не затирать, а перекладывать в папочку history
5. Удалённые файлы из архива не удалять, а перекладывать в папочку history (также с датой архивирования)
6. В случае обнаружения новых папок предупреждение в лог
7. В случае обнаружения удалённых папок предупреждение в лог (чтобы можно было отследить перемещения папок (в том числе и ошибочное) с места на место
8. Если обнаруживается удалённая папка (это может быть сознательное удаление, перемещение или переименование, или случайное перемещение, или случайное удаление), то удалённую папку из архива надо целиком перенести в папку deleted, чтобы потом постфактум иметь возможность интерактивно:

* А) подтвердить удаление, перенеся все файлы из папки deleted в папку history с простановкой даты архивирования
* Б) обнаружить перемещение или переименование, соответствующим образом переименовав предыдущий клон этой папки в папке history и просто удалив резервную копию из папки deleted (ибо в папке current у нас должна была появиться якобы новая папка с полным набором файлов, при этом решить проблему анализа истории изменений файлов в свежеперемещённой папке и в старой папке из каталога deleted)
* В) в случае случайного перемещения надо будет откатить перемещение (переместить папку обратно) в источнике, а также переместить папку на место в папке current и удалить папку из папки deleted (ибо полный комплект рабочих файлов у нас существует свежескопированным (при этом мы теряем историю изменений в свежеперемещённой папке и в папке deleted, как-то надо решить эту проблему))
* Г) в случае случайного удаления надо будет резервную копию из папки deleted переложить на место сначала в папку current, а затем и в исходную папку.

Если вы каким-то образом сюда попали и посмотрели код, то пожалуйста, выскажите свои пожелания, правки и т.п. =)
